const BASE_URL='https://games.hndibei.com';export default class EyouClientKs{constructor(){let F=null,I=0x9,n=null,q=null,f='-1',s='-1',o='4',i=null,X=null,u=null,w=null,t=null,C=null;const j=new Map();let P=null;const K=(S,J)=>{S['gameId']=F,(S['platformId']=I,S['sys']=o),B(S)['then'](O=>{if(O['payType']==0x4)tt['previewImage']({'urls':[O['payUrl']],'showmenu':!![]});else{if(O['payType']==0x8)O['balance']>0x0?r('充值提示','账户余额:'+O['balance']+'元,\x20还需充值:'+O['needPay']+'元',()=>l(O,J)):l(O,J);else{if(O['payType']==0x9)O['balance']>0x0?r('充值提示','账户余额:'+O['balance']+'元,\x20还需充值:'+O['needPay']+'元',()=>L(O,J)):L(O,J);else throw new Error('非法支付类型');}}});},l=(S,J)=>{if(S['needPay']==0x0){x(S,J);return;}tt['requestGamePayment']({'mode':'game','env':0x0,'currencyType':'CNY','platform':'android','buyQuantity':S['needPay']*S['rate'],'zoneId':S['zoneId'],'customId':S['orderId'],'extraInfo':S['orderId'],'success':O=>{x(S,J);}});},L=(S,J)=>{if(S['needPay']==0x0){x(S,J);return;}tt['openAwemeCustomerService']({'buyQuantity':S['needPay']*S['rate'],'customId':S['orderId'],'currencyType':'CNY','zoneId':S['zoneId'],'extraInfo':S['orderId'],'success':O=>{J({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});},'fail':O=>{J({'code':CodeStatus['FAIL'],'message':'操作失败','data':null});}});},h=BASE_URL+'/market-multi-game-server/kuaiShouClient/deduct',x=async(S,J)=>{try{const O={'orderId':S['orderId'],'gameId':F,'platformId':I,'userId':S['userId']};let d=await p(h,O);d['code']===CodeStatus['SUCCESS']&&J(d);}catch(k){console['error']('[扣款失败]异常:>',k);}},e=BASE_URL+'/market-multi-game-server/kuaiShouClient/pullPay',B=async S=>{const J=0x3;let O=0x0,d=![],k=![];while(O<J&&!d){try{const g=await p(e,S);if(g['code']===CodeStatus['SUCCESS'])return g['data'];else!k&&(r('支付拉起失败',g['message']),k=!![]);}catch(W){!k&&(r('支付拉起失败','网络超时'),k=!![]);}O++;}throw new Error('支付拉起失败');},Q=()=>{return new Promise((S,J)=>{ks['login']({'force':!![],'success':({code:O})=>{O?(console['log']('code:>',O),S(O)):J(new Error('获取code失败'));},'fail':J});});},c=S=>{F=S;const J=ks['getSystemInfoSync']();o=J['platform']==='android'?'4':J['platform']==='ios'?'5':'6';const O=ks['getLaunchOptionsSync']()['query'];O&&(n=O['channel'],q=O['sub_channel']);const d={'10913':['unit_id','callback']};if(d['hasOwnProperty'](n)){const [k,g]=d[n];f=O[k],s=O[g];}else n='10906',q=''+F+I+n+o+'0';},E=BASE_URL+'/market-multi-game-server/kuaiShouClient/adAction',m=(S,J,O)=>{let d={'gameId':F,'platformId':I,'channelId':n,'subChannelId':q,'aid':f,'traceId':s,'sys':o,'userId':X,'adType':S,'adUnitId':J,'adActionType':O};p(E,d)['catch'](k=>{console['log']('发送广告行为失败:>',k);});},M=S=>{let J=j['get'](S);if(!J)throw new Error('未创建编号为'+S+'的客服按钮');return J;},T=()=>{if(!P)throw new Error('未创建录屏管理器');},V=(S,J)=>{J(S);},r=(S,J,O,d)=>{tt['showModal']({'title':S,'content':J,'success':function(k){if(k['confirm']&&O)O();else k['cancel']&&d&&d();}});},p=(S,J)=>{return new Promise((O,d)=>{ks['request']({'url':S,'method':'POST','header':{'Content-Type':'application/json;charset=UTF-8'},'data':JSON['stringify'](J),'fail':d,'success':function(k){O(k['data']);},'complete':function(k){console['log']('---------------------------------请求\x20BEGIN--------------------------------'),console['log']('Url:>',S),console['log']('请求参数:>',J);const g=k&&(k['data']||k['errMsg'])?k['data']||k['errMsg']:'No\x20response\x20data';console['log']('响应:>',g),console['log']('---------------------------------请求\x20END--------------------------------');}});});},H=BASE_URL+'/market-multi-game-server/kuaiShouClient/initGame';this['init']=async(S,J)=>{try{ks['onShareAppMessage'](k=>{return{'templateId':w,'query':'','success':()=>{console['log']('分享成功');},'fail':g=>{console['log']('分享失败',g);}};}),i=await Q(),c(S);const O={'code':i,'gameId':F,'platformId':I,'channelId':n,'subChannelId':q,'aid':f,'traceId':s,'sys':o},d=await p(H,O);d['code']===CodeStatus['SUCCESS']&&(X=d['data']['userId'],u=d['data']['unionId'],w=d['data']['shareTemplateId'],d['data']=null),J(i);}catch(k){console['error']('[初始化游戏]异常:>',k);}},this['login']=async S=>{S({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':{'code':i}});},this['pay']=async(S,J)=>{tt['checkSession']({'success':O=>{try{K(S,J);}catch(d){console['error']('[支付拉起]异常:>',d);}},'fail':O=>{tt['login']({'success':d=>{try{K(S,J);}catch(k){console['error']('[支付拉起]异常:>',k);}}});}});};const G=BASE_URL+'/market-multi-game-server/kuaiShouClient/uploadRoleInfo';this['uploadRoleInfo']=async(S,J)=>{try{S['gameId']=F,S['platformId']=I;const O=await p(G,S);J(O);}catch(d){console['error']('上报角色数据异常:>',d);}};const b=BASE_URL+'/market-multi-game-server/kuaiShouClient/antidirt';this['antidirt']=async(S,J)=>{try{let O={'gameId':F,'platformId':I,'contents':S};const d=await p(b,O);J(d);}catch(k){console['error']('[内容安全检测]异常:>',k);}},this['createRewardedVideoAd']=(S,J)=>{let O={'adUnitId':S['adUnitId']};S['multiton']&&(O['multiton']=S['multiton'],O['multitonRewardMsg']=S['multitonRewardMsg'],O['multitonRewardTimes']=S['multitonRewardTimes']),S['progressTip']&&(O['progressTip']=S['progressTip']),C=ks['createRewardedVideoAd'](O),C['onClose'](d=>{d&&d['isEnded']&&(m(AdType['REWARDED_VIDEO_AD'],t,AdActionType['FINISHED']),console['log']('正常播放结束，可以下发游戏奖励')),S['onClose']&&S['onClose'](d),C['destroy']();}),S['onError']&&C['onError'](d=>{S['onError']&&S['onError'](d),C['destroy']();}),t=S['adUnitId'],J({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});},this['showRewardedVideoAd']=()=>{C&&(C['load'](),C['show']()['then'](()=>m(AdType['REWARDED_VIDEO_AD'],t,AdActionType['SHOW']))['catch'](S=>{C['load']()['then'](()=>{C['show']()['then'](()=>m(AdType['REWARDED_VIDEO_AD'],t,AdActionType['SHOW']));})['catch'](J=>console['log']('激励视频\x20广告显示失败'));}));},this['createContactButton']=(S,J)=>{const O=tt['createContactButton'](S);j['set'](j['size'],O),J({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':{'contactBtnNo':j['size']-0x1}});},this['contactBtnDestory']=S=>{let J=M(S);J['destory'](),j['set'](S,null);},this['contactBtnShow']=S=>{let J=M(S);J['show']();},this['contactBtnHide']=S=>{let J=M(S);J['hide']();},this['createGameRecorder']=(S,J)=>{P=ks['getGameRecorder'](),S['onStart']&&P['on']('start',S['onStart']),S['onResume']&&P['on']('resume',S['onResume']),S['onPause']&&P['on']('pause',S['onPause']),S['onStop']&&P['on']('stop',S['onStop']),S['onError']&&P['on']('error',S['onError']),S['onAbort']&&P['on']('abort',S['onAbort']),J({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});},this['gameRecorderStart']=S=>{T(),P['start'](S);},this['gameRecorderPause']=()=>{T(),P['pause']();},this['gameRecorderResume']=()=>{T(),P['resume']();},this['gameRecorderStop']=()=>{T(),console['log']('触发停止录屏'),P['stop']();},this['publishVideo']=S=>{T(),P['publishVideo']({'video':S['videoID'],'callback':J=>{if(J!=null&&J!=undefined){console['log']('分享录屏失败:\x20',J);return;}console['log']('分享录屏成功');}});},this['shareAppMessage']=(S,J)=>{ks['shareAppMessage']({...S,'templateId':w,'success':()=>{J({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});},'fail':O=>{console['log']('[分享失败]:>',O),J({'code':CodeStatus['FAIL'],'message':'操作失败','data':null});}});},this['addShortcut']=S=>{ks['addShortcut']({'complete':S});},this['addCommonUse']=S=>{ks['addCommonUse']({'complete':S});},this['checkSidebar']=S=>{tt['checkScene']({'scene':'sidebar','success':J=>{J&&J['isExist']&&S({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});}});},this['navigateToSidebar']=S=>{tt['navigateToScene']({'scene':'sidebar','success':J=>{S({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});},'fail':J=>{console['log']('[跳转侧边栏失败]:>',J),S({'code':CodeStatus['FAIL'],'message':'操作失败','data':null});}});},this['onFromSidebar']=S=>{tt['onShow'](({scene:J,launch_from:O,location:d})=>{J=='021036'&&O=='homepage'&&d=='sidebar_card'&&S({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':null});});},this['onKeyboardComplete']=S=>{const J=O=>{S({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':O}),tt['offKeyboardComplete'](J);};tt['onKeyboardComplete'](J);},this['requestSubscribeMessage']=(S,J)=>{tt['requestSubscribeMessage']({'tmplIds':S,'success':O=>{let d=Object['keys'](O)['filter'](k=>O[k]==='accept');J({'code':CodeStatus['SUCCESS'],'message':'操作成功','data':d});},'fail':O=>{J({'code':CodeStatus['FAILED'],'message':O['errMsg'],'data':null});}});};}static['getIns'](){return!this['ins']&&(this['ins']=new EyouClientKs()),this['ins'];}}class CodeStatus{static ['SUCCESS']=0x0;static ['FAIL']=-0x1;}class AdType{static ['REWARDED_VIDEO_AD']=0x1;static ['BANNER_AD']=0x2;}class AdActionType{static ['SHOW']=0x1;static ['FINISHED']=0x2;}